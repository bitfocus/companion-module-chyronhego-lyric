import { InstanceStatus, Regex } from '@companion-module/base'

export const EOL = '\r\n'
export const keep_alive_timeout = 30000
export const default_port = 23

export const cmd = {
	ping: 'W\\1002\\6001\\Pinging\\Chyron',
	changeColor: 'C',
	macro: 'E',
	changeFont: 'F',
	setDriveAndMessageDirectory: 'M',
	resendPrevious: 'Q',
	updateTabDataField: 'U',
	control: 'V',
	read: 'V\\5\\3\\1\\',
	writeTabData: 'W',
	requestExternalUpdate: 'X', //Also R
	assorted: 'Y', //!!!
	eom: '\\\\',
	sep: '\\',
}

export const loginMsg = {
	welcome: 'Welcome to the ChyronHego Intelligent Interface Telnet Server on',
	inUse: 'already in use',
}

export const msgSuccess = '*'
export const errorCodes = [
	{ code: '0001', label: 'Task timed out', status: InstanceStatus.UnknownError },
	{ code: '0002', label: 'Unimplemented system service', status: InstanceStatus.UnknownError },
	{ code: '0003', label: 'Illegal service', status: InstanceStatus.UnknownError },
	{ code: '0004', label: 'Illegal node', status: InstanceStatus.UnknownError },
	{ code: '0005', label: 'Object has been deleted', status: InstanceStatus.UnknownError },
	{ code: '0006', label: 'Invalid object ID', status: InstanceStatus.UnknownWarning },
	{ code: '0007', label: 'Incorrect object ID', status: InstanceStatus.UnknownWarning },
	{ code: '0008', label: 'Incorrect object type', status: InstanceStatus.UnknownWarning },
	{ code: '0009', label: 'Object not found', status: InstanceStatus.UnknownWarning },
	{ code: '0014', label: 'Cannot create message - No task control blocks', status: InstanceStatus.UnknownWarning },
	{ code: '0015', label: 'Cannot create message - No stack space available', status: InstanceStatus.UnknownWarning },
	{
		code: '0016',
		label: 'Cannot create the message -The stack space is too small',
		status: InstanceStatus.UnknownWarning,
	},
	{ code: '0017', label: 'Cannot create the message -Priority out of range', status: InstanceStatus.UnknownWarning },
	{ code: '0018', label: 'Cannot start the process - Already active', status: InstanceStatus.UnknownWarning },
	{
		code: '0019',
		label: 'Cannot restart the process - The process was never started',
		status: InstanceStatus.UnknownWarning,
	},
	{
		code: '0020',
		label: 'Cannot suspend process - Process is already suspended',
		status: InstanceStatus.UnknownWarning,
	},
	{ code: '0021', label: 'Cannot resume process - It was never suspended', status: InstanceStatus.UnknownWarning },
	{ code: '0022', label: 'Cannot change priority - Out of range', status: InstanceStatus.UnknownWarning },
	{ code: '0023', label: 'Illegal task register number', status: InstanceStatus.UnknownWarning },
	{ code: '0024', label: 'Cannot delete - File is open', status: InstanceStatus.UnknownWarning },
	{ code: '0051', label: 'Cannot create - No more queue control blocks', status: InstanceStatus.UnknownWarning },
	{ code: '0052', label: 'Cannot create or send - No message buffers', status: InstanceStatus.UnknownWarning },
	{ code: '0053', label: 'Cannot send - The message queue is full', status: InstanceStatus.UnknownWarning },
	{ code: '0054', label: 'Cannot receive - The queue has been deleted', status: InstanceStatus.UnknownWarning },
	{ code: '0055', label: 'Cannot receive - There are no pending messages', status: InstanceStatus.UnknownWarning },
	{
		code: '0056',
		label: 'Informative - There were tasks waiting when the queue was deleted',
		status: InstanceStatus.UnknownWarning,
	},
	{
		code: '0057',
		label: 'Informative - There were messages waiting when the queue was deleted',
		status: InstanceStatus.UnknownWarning,
	},
	{ code: '0066', label: 'Cannot acquire - Semaphore not available', status: InstanceStatus.UnknownWarning },
	{ code: '0067', label: 'Cannot acquire - Semaphore deleted while waiting' },
	{
		code: '0068',
		label: 'Informative - There were tasks waiting when the Semaphore was deleted',
		status: InstanceStatus.UnknownWarning,
	},
	{ code: '2001', label: 'An invalid function number was called', status: InstanceStatus.UnknownWarning },
	{ code: '2002', label: 'pHILE failure was encountered', status: InstanceStatus.UnknownError },
	{ code: '2003', label: 'An inconsistent structure was found on the volume', status: InstanceStatus.UnknownWarning },
	{ code: '2005', label: 'Init volume parameter error', status: InstanceStatus.UnknownWarning },
	{ code: '2006', label: 'No more volume table entries', status: InstanceStatus.UnknownWarning },
	{ code: '2007', label: 'Alien volume', status: InstanceStatus.UnknownWarning },
	{ code: '2008', label: 'Volume already mounted', status: InstanceStatus.UnknownWarning },
	{ code: '2009', label: 'Cannot unmount - there are files open', status: InstanceStatus.UnknownWarning },
	{ code: '200A', label: 'Device not mounted', status: InstanceStatus.UnknownWarning },
	{ code: '200B', label: 'File not found', status: InstanceStatus.UnknownWarning },
	{ code: '200C', label: 'Illegal filename', status: InstanceStatus.UnknownWarning },
	{ code: '200D', label: 'No Default Directory found', status: InstanceStatus.UnknownWarning },
	{ code: '200E', label: 'Directory file expected', status: InstanceStatus.UnknownWarning },
	{ code: '200F', label: 'Illegal annex size to create', status: InstanceStatus.UnknownWarning },
	{ code: '2010', label: 'Null filename', status: InstanceStatus.UnknownWarning },
	{ code: '2011', label: 'File already exists', status: InstanceStatus.UnknownWarning },
	{ code: '2012', label: 'F list full', status: InstanceStatus.UnknownWarning },
	{ code: '2013', label: 'File open', status: InstanceStatus.UnknownWarning },
	{ code: '2014', label: 'Directory is not empty', status: InstanceStatus.UnknownWarning },
	{ code: '2015', label: 'System or directory file', status: InstanceStatus.UnknownWarning },
	{ code: '2016', label: 'Different devices (MOVE_F)', status: InstanceStatus.UnknownWarning },
	{ code: '2017', label: 'MOVE_F would result in non tree structure', status: InstanceStatus.UnknownWarning },
	{ code: '2018', label: 'No more open file entries', status: InstanceStatus.UnknownWarning },
	{ code: '2019', label: 'No more FCBs', status: InstanceStatus.UnknownWarning },
	{ code: '201A', label: 'Invalid FID, too large', status: InstanceStatus.UnknownWarning },
	{ code: '201B', label: 'Invalid FID, file closed', status: InstanceStatus.UnknownWarning },
	{ code: '201C', label: 'Indirect block full', status: InstanceStatus.UnknownWarning },
	{ code: '201D', label: 'Volume full', status: InstanceStatus.UnknownWarning },
	{ code: '201E', label: 'Bad position to lseek', status: InstanceStatus.UnknownWarning },
	{ code: '201F', label: 'Seek past end of file', status: InstanceStatus.UnknownWarning },
	{ code: '2021', label: 'Illegal device (exceeded maximum)', status: InstanceStatus.UnknownWarning },
	{ code: '2022', label: 'Data is locked', status: InstanceStatus.UnknownWarning },
	{ code: '2023', label: 'Bad fn in OPEN_VOL', status: InstanceStatus.UnknownWarning },
	{ code: '2024', label: 'Illegal flush mode to MOUNT_VOL', status: InstanceStatus.UnknownWarning },
	{ code: '2025', label: 'Illegal device name', status: InstanceStatus.UnknownWarning },
	{ code: '2026', label: 'Bad MS/DOS call', status: InstanceStatus.UnknownWarning },
	{ code: '2027', label: 'Illegal MS disk type', status: InstanceStatus.UnknownWarning },
	{ code: '2028', label: 'More than one type of MS disk type', status: InstanceStatus.UnknownWarning },
	{ code: '2040', label: 'Used Tab page', status: InstanceStatus.UnknownWarning },
	{ code: '2F01', label: 'Insufficient data area', status: InstanceStatus.UnknownWarning },
	{ code: '2F0E', label: 'Check sum in pHILE', status: InstanceStatus.UnknownWarning },
	{ code: '400B', label: 'Check sum in pVERIFY+', status: InstanceStatus.UnknownWarning },
	{ code: '40B2', label: 'Checksum does not match computed checksum', status: InstanceStatus.UnknownWarning },
	{ code: '40B3', label: 'Requested message directory does not exist', status: InstanceStatus.UnknownWarning },
	{ code: '412C', label: 'Requested message file does not exist', status: InstanceStatus.UnknownWarning },
	{
		code: '412D',
		label: 'Requested description file is not a Tab Description file',
		status: InstanceStatus.UnknownWarning,
	},
	{ code: '412E', label: 'Requested field is not a valid field', status: InstanceStatus.UnknownWarning },
	{ code: '412F', label: 'Requested attribute (Color or Font) is not valid', status: InstanceStatus.UnknownWarning },
	{ code: '4130', label: 'Field contains too much data (limit 64 characters)', status: InstanceStatus.UnknownWarning },
	{
		code: '4131',
		label: 'Incorrect number of fields, R command does not match X command',
		status: InstanceStatus.UnknownWarning,
	},
	{
		code: '415E',
		label: 'Description message was created with old Tabs (Templates)',
		status: InstanceStatus.UnknownWarning,
	},
	{ code: '415F', label: 'Number of Tabs (Templates) exceeds limit (99)', status: InstanceStatus.UnknownWarning },
	{ code: '4190', label: 'Desired operation is not terminated with "\\\\"', status: InstanceStatus.UnknownWarning },
	{ code: '4191', label: 'The command format is incorrect', status: InstanceStatus.UnknownWarning },
	{ code: '4192', label: 'An invalid operation has been requested', status: InstanceStatus.UnknownWarning },
	{ code: '4193', label: 'An invalid Machine ID has been used', status: InstanceStatus.UnknownWarning },
	{ code: '4194', label: 'An invalid Effects ID has been used', status: InstanceStatus.UnknownWarning },
	{ code: '41C2', label: 'An invalid User ID has been used (either 1 or 2)', status: InstanceStatus.UnknownWarning },
	{
		code: '41C3',
		label: 'An invalid Keyboard ID has been used (either 1 or 2)',
		status: InstanceStatus.UnknownWarning,
	},
	{
		code: '41C4',
		label: 'The command to set the active message compose frame buffer failed',
		status: InstanceStatus.UnknownWarning,
	},
	{ code: '41C5', label: 'An invalid Frame Buffer ID was used (1, 2, or 3)', status: InstanceStatus.UnknownWarning },
	{
		code: '41C6',
		label:
			'Error building into a non-displaying buffer; a bad message type was used or no Read Next command was issued',
		status: InstanceStatus.UnknownWarning,
	},
	{ code: '41C7', label: 'Command to set Palette failed', status: InstanceStatus.UnknownWarning },
	{ code: '41C8', label: 'Color Key out of range; must be 1 - 8', status: InstanceStatus.UnknownWarning },
	{ code: '41C9', label: 'Palette Index out of range; must be 1 - 31', status: InstanceStatus.UnknownWarning },
	{ code: '41CA', label: 'Color Index out of range; must be 0 - 255', status: InstanceStatus.UnknownWarning },
	{ code: '41CB', label: 'Key out of range; must be 0 - 1', status: InstanceStatus.UnknownWarning },
	{
		code: '41CC',
		label: 'Attempted to perform a Dual-User operation in Single-User mode',
		status: InstanceStatus.UnknownWarning,
	},
	{ code: '41CD', label: 'Timed out waiting for response', status: InstanceStatus.UnknownWarning },
	{ code: '41CE', label: 'Error building Message Compose Palette', status: InstanceStatus.UnknownWarning },
	{ code: '41CF', label: 'Error erasing displayed Frame Buffer', status: InstanceStatus.UnknownWarning },
	{ code: '41D0', label: 'Display/Non-Display flag out of range, i.e., 0 - 1', status: InstanceStatus.UnknownWarning },
	{ code: '41D1', label: 'No Intelligent Interface option', status: InstanceStatus.UnknownError },
	{ code: '41D2', label: 'Bitmap not created', status: InstanceStatus.UnknownWarning },
	{ code: '41D3', label: 'Bitmap file not found', status: InstanceStatus.UnknownWarning },
	{ code: '41D4', label: 'Invalid Field Number', status: InstanceStatus.UnknownWarning },
	{ code: '41D5', label: 'Missing Macro', status: InstanceStatus.UnknownWarning },
	{ code: '41D6', label: 'Macro Error', status: InstanceStatus.UnknownWarning },
	{ code: '41D7', label: 'Duplicate Macro', status: InstanceStatus.UnknownWarning },
	{ code: '41D8', label: 'Another Macro currently executing', status: InstanceStatus.UnknownWarning },
	{ code: '41D9', label: 'Another Macro currently recording', status: InstanceStatus.UnknownWarning },
	{ code: '41DA', label: 'Item referenced in Macro was not found', status: InstanceStatus.UnknownWarning },
	{ code: '41DB', label: 'File referenced in Macro was not found', status: InstanceStatus.UnknownWarning },
	{ code: '5000', label: 'New Playlist created', status: InstanceStatus.UnknownWarning },
	{ code: '5001', label: 'Invalid Playlist Number', status: InstanceStatus.UnknownWarning },
	{ code: '5002', label: 'No Playlist loaded', status: InstanceStatus.UnknownWarning },
	{ code: '5003', label: 'File not Playlist', status: InstanceStatus.UnknownWarning },
	{ code: '5004', label: 'Old version of Playlist', status: InstanceStatus.UnknownWarning },
	{ code: '5005', label: 'Playlist already exists', status: InstanceStatus.UnknownWarning },
	{ code: '5006', label: 'Playlist finished executing', status: InstanceStatus.UnknownWarning },
	{ code: '5010', label: 'Invalid Playlist Entry Number', status: InstanceStatus.UnknownWarning },
	{ code: '5011', label: 'Error allocating Playlist Entry', status: InstanceStatus.UnknownWarning },
	{ code: '5012', label: 'Error adding Playlist Entry', status: InstanceStatus.UnknownWarning },
	{ code: '5020', label: 'Invalid Channel allocated', status: InstanceStatus.UnknownWarning },
	{ code: '5021', label: 'No Channel allocated', status: InstanceStatus.UnknownWarning },
	{ code: '5022', label: 'No Frame Buffer allocated', status: InstanceStatus.UnknownWarning },
	{ code: '5030', label: 'Invalid Still Message Number', status: InstanceStatus.UnknownWarning },
	{ code: '5031', label: 'Still File not found', status: InstanceStatus.UnknownWarning },
	{ code: '5050', label: 'Invalid IMAGESTOR! command', status: InstanceStatus.UnknownWarning },
	{ code: '5051', label: 'Invalid Effect', status: InstanceStatus.UnknownWarning },
	{ code: '5052', label: 'Invalid Pattern', status: InstanceStatus.UnknownWarning },
	{ code: '5053', label: 'Invalid Speed', status: InstanceStatus.UnknownWarning },
	{ code: '5054', label: 'Invalid Ease parameter', status: InstanceStatus.UnknownWarning },
	{ code: '5055', label: 'Invalid Reverse parameter', status: InstanceStatus.UnknownWarning },
	{ code: '5056', label: 'Invalid Keyboard Lock Status', status: InstanceStatus.UnknownWarning },
	{ code: '7000', label: 'No memory to create outline', status: InstanceStatus.UnknownWarning },
	{ code: '7004', label: 'No Frame Buffer available for graph', status: InstanceStatus.UnknownWarning },
	{ code: '7008', label: 'No memory for the Fill Line Buffer', status: InstanceStatus.UnknownWarning },
	{ code: '7100', label: 'Line segment not between 0 and MAX_LINE_SEG', status: InstanceStatus.UnknownWarning },
	{
		code: '7108',
		label: 'Invalid Pulse parameter specified, i.e., not _PULSE(0) or _NON_PULSE(1)',
		status: InstanceStatus.UnknownWarning,
	},
	{
		code: '710C',
		label: 'Invalid display buffer specified, i.e., not _DBUF(0) or _NBUF(1)',
		status: InstanceStatus.UnknownWarning,
	},
	{
		code: '7110',
		label: 'Invalid Trigger type specified, i.e., not _REGULAR_LINE(0), _PULSE_LINE(1) or _BOTH(2)',
		status: InstanceStatus.UnknownWarning,
	},
	{
		code: '7114',
		label: 'Invalid Mode specified, i.e., not _ENTIRE_LINE(0) or _LAST_SEGMENT(1)',
		status: InstanceStatus.UnknownWarning,
	},
	{
		code: '7118',
		label: 'Specified Pacing value outside of range, i.e., not between -30 and 30',
		status: InstanceStatus.UnknownWarning,
	},
	{ code: '7200', label: 'Brush not successfully created', status: InstanceStatus.UnknownWarning },
	{
		code: '7204',
		label: 'Invalid Edge specified, i.e., not _HARD(0), _SOFT(1), _SOFT_EDGE(2) or _CLEAR(3)',
		status: InstanceStatus.UnknownWarning,
	},
	{ code: '7208', label: 'Invalid Transparency, i.e., not between 0 and 100', status: InstanceStatus.UnknownWarning },
	{ code: '720C', label: 'Brush diameter out of range', status: InstanceStatus.UnknownWarning },
	{
		code: '7210',
		label: 'Invalid RGBA file name, i.e., RGBA value has more than 8 digits',
		status: InstanceStatus.UnknownWarning,
	},
	{ code: '7300', label: 'Point not added to outline', status: InstanceStatus.UnknownWarning },
	{ code: '7304', label: 'No outline exists for this line segment', status: InstanceStatus.UnknownWarning },
	{ code: '8001', label: 'Wrong Read Effect task', status: InstanceStatus.UnknownWarning },
	{ code: '8002', label: 'Bad Read Effect command', status: InstanceStatus.UnknownWarning },
	{ code: '8003', label: 'Wrong Read Effect command', status: InstanceStatus.UnknownWarning },
	{ code: '8004', label: 'Bad Read Effect Mode', status: InstanceStatus.UnknownWarning },
	{ code: '8005', label: 'Bad Read Effect Ease', status: InstanceStatus.UnknownWarning },
	{ code: '8006', label: 'Bad Read Effect Speed', status: InstanceStatus.UnknownWarning },
	{ code: '8007', label: 'Bad Read Effect Type', status: InstanceStatus.UnknownWarning },
	{ code: '8008', label: 'Bad Read Effect Reverse', status: InstanceStatus.UnknownWarning },
	{ code: '8009', label: 'Bad Read Effect Row Direction', status: InstanceStatus.UnknownWarning },
	{ code: '800A', label: 'Bad Mix Effect Percent', status: InstanceStatus.UnknownWarning },
	{ code: '800B', label: 'Bad Mix Effect Soft Edge', status: InstanceStatus.UnknownWarning },
	{
		code: '800C',
		label: 'Rows cannot be wiped left and right on old frame buffer',
		status: InstanceStatus.UnknownWarning,
	},
	{ code: '800D', label: 'Must specify one row Up or Down', status: InstanceStatus.UnknownWarning },
	{ code: '800E', label: 'Invalid Effect type', status: InstanceStatus.UnknownWarning },
	{ code: '800F', label: 'No memory available for row type', status: InstanceStatus.UnknownWarning },
	{ code: '8010', label: 'Frame buffer error occurred', status: InstanceStatus.UnknownWarning },
	{
		code: '8011',
		label: 'Frame buffer in use by another task, e.g., Clock, Flash',
		status: InstanceStatus.UnknownWarning,
	},
	{ code: '805001', label: 'Bad Transform syntax', status: InstanceStatus.UnknownWarning },
	{ code: '805002', label: 'Bad Transform script', status: InstanceStatus.UnknownWarning },
	{ code: '805003', label: 'Bad Transform directory', status: InstanceStatus.UnknownWarning },
	{ code: '805004', label: 'Bad Transform message', status: InstanceStatus.UnknownWarning },
	{ code: '805005', label: 'Bad Transform value', status: InstanceStatus.UnknownWarning },
	{ code: '805006', label: 'Ignored', status: InstanceStatus.UnknownWarning },
	{ code: '805007', label: 'Bad Transform command', status: InstanceStatus.UnknownWarning },
	{ code: '805008', label: 'Transform not available', status: InstanceStatus.UnknownWarning },
]

const textField = {
	type: 'textinput',
	useVariables: true,
	default: '',
	regex: Regex.SOMETHING,
}

const choices = {
	buffer: [
		{ id: '0', label: 'VGA' },
		{ id: '1', label: 'Frame Buffer 1' },
		{ id: '2', label: 'Frame Buffer 2' },
	],
	displayMode: [
		{ id: '0', label: 'Read Next (Prebuild)' },
		{ id: '1', label: 'Read & Display' },
	],
}

export const actionOptions = {
	macro: {
		...textField,
		label: 'Macro',
		id: 'macro',
		tooltip: `Any VB Script command that can be executed via Lyric Macros may be contained in an E command.  Each command is separated by a "tilde" (~) character.`,
	},
	macroInfo: {
		type: 'static-text',
		id: 'info',
		label: '',
		value: `Note the following about building macro subroutines using Intelligent Interface: The name of the macro subroutine that is built via Intelligent Interface cannot duplicate the name of any of the macros currently loaded in the Macros dialog box.  If there is a duplication, Intelligent Interface returns a 000041d7 (Duplicate Macro) error code. See below for A macro subroutine that is built via Intelligent Interface is not loaded into the Macros dialog box, and therefore does not appear in the dialog box. A macro subroutine that is successfully sent to Lyric can be overwritten, i.e., subsequent macros that are sent can have the same name.  The name restriction applies only to macros that are listed in the Macro dialog box. Additionally, if the macro engine is reset, the script must be resent. The E command can also trigger a loaded macro by executing its Hot Key.  Suppose that a macro script in Lyric is assigned the hot key trigger Alt + 3, meaning that it executes when Alt + 3 is pressed.  The following example uses a VB Script command to set up a shell object that passes commands to the Windows command interpreter.  A second VB Script command then sends the key combination Alt + 3, specified in VB Script as %3, triggering the macro script.E\\set WshShell = CreateObject ("WScript.Shell")~WshShell.SendKeys("%3")\\\\<CR><LF>`,
	},
	readBuffer: {
		id: 'buffer',
		label: 'Buffer',
		type: 'dropdown',
		choices: choices.buffer,
		default: choices.buffer[1].id,
		tooltip: 'Specifies destination of the message',
		allowCustom: false,
	},
	readMessage: {
		...textField,
		label: 'Lyric Message Number',
		id: 'message',
	},
	readDisplayMode: {
		id: 'mode',
		label: 'Display Mode',
		type: 'dropdown',
		choices: choices.displayMode,
		default: choices.displayMode[1].id,
	},
	customMessage: {
		...textField,
		label: 'Custom Message',
		id: 'message',
		tooltip: `Send custom message. Module will appead \\\\\\r\\n to the end.`,
	},
}
